import{j as e,T as t,a as s,b as a}from"./components-small-CitHElKP.js";import{r as o,l as r,C as n,m as i,n as c,B as l,F as d,o as u}from"./vendor-gestalt-DclyTH-S.js";import{a as m}from"./vendor-react-BtDQ8f-S.js";import{a as f,t as g}from"./services-DZcqk9oA.js";import{G as h,o as p,k as y,l as j,m as k}from"./vendor-firebase-UVmS2xuE.js";import{A as S}from"./component-header-Gowtr5TB.js";import{L as b}from"./component-login-Bx3LS22B.js";import{T as x}from"./component-tasklist-CKlD1UOv.js";import{s as w,u as T}from"./utils-DZ3OUguQ.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var E,v={};var L=function(){if(E)return v;E=1;var e=m();return v.createRoot=e.createRoot,v.hydrateRoot=e.hydrateRoot,v}();function C(){const[m,E]=o.useState(w.get("theme","lightWash")),[v,L]=o.useState(w.get("language","pt")),[C,I]=o.useState(!1),[M,O]=o.useState(""),[R,W]=o.useState([]),[z,A]=o.useState(""),[G,N]=o.useState("all"),[P,B]=o.useState(!1),[D,F]=o.useState(null),[q,K]=o.useState(!1),H=new h,J=T(),Q=new r(10),U=new n([Q]);o.useEffect((()=>w.set("theme",m)),[m]),o.useEffect((()=>w.set("language",v)),[v]),o.useEffect((()=>{if(!D){const e=w.get("tasks",[]);W(e)}}),[]),o.useEffect((()=>{const e=p(f,(async e=>{if(F(e),e)try{B(!0);const t=await g.syncTasks(e.uid);W(t),w.set("tasks",t),V("Tarefas sincronizadas com sucesso!")}catch(t){V("Erro ao sincronizar tarefas")}finally{B(!1)}}));return()=>e()}),[]),o.useEffect((()=>{D||w.set("tasks",R)}),[R,D]);const V=e=>{O(e),I(!0),setTimeout((()=>I(!1)),3e3)},X=async()=>{try{await k(f),F(null);const e=w.get("tasks",[]);W(e)}catch(e){}},Y=R.filter((e=>{const t=e.text.toLowerCase().includes(z.toLowerCase());return"completed"===G?t&&e.completed:"pending"===G?t&&!e.completed:t}));return e.jsx(i,{deviceType:J?"mobile":"desktop",children:e.jsx(c,{colorScheme:m,children:e.jsxs(l,{as:"main",margin:"auto",padding:4,width:"100%",color:"lightWash"===m?"lightWash":"dark",rounding:0,justifyContent:"center",display:"block",height:"100vh",children:[e.jsx(S,{theme:m,language:v,isMobile:J,user:D,toggleTheme:()=>E((e=>"lightWash"===e?"dark":"lightWash")),setLanguage:L,handleSignOut:X,setOpenLoginModal:K}),e.jsx(b,{isOpen:q,onClose:()=>K(!1),onLoginEmail:async(e,t)=>{try{const s=await y(f,e,t);F(s.user),K(!1)}catch(s){alert("Erro ao logar com email: "+s.message)}},onLoginGoogle:async()=>{try{const e=await j(f,H);F(e.user),K(!1)}catch(e){alert("Erro ao logar com Google: "+e.message)}},onSignOut:X,user:D,language:v,zIndex:U}),e.jsx(t,{onAddTask:async(e,t)=>{const s={id:Date.now().toString(),text:e,category:t,completed:!1};try{if(D){B(!0);const e=await g.addTask(s,D.uid);W((t=>[...t,e]))}else W((e=>[...e,s]))}catch(a){V("Erro ao adicionar tarefa")}finally{B(!1)}},language:v,isMobile:J,disabled:P}),e.jsx(s,{searchTerm:z,filterStatus:G,onSearchChange:A,onFilterChange:N,language:v,isMobile:J,disabled:P}),P?e.jsx(d,{alignItems:"center",justifyContent:"center",height:"200px",children:e.jsx(u,{show:!0,accessibilityLabel:"Carregando tarefas"})}):e.jsx(x,{tasks:Y,onToggleTask:async e=>{try{const t=R.find((t=>t.id===e));if(!t)return;const s={...t,completed:!t.completed};D&&s.firebaseId&&(B(!0),await g.updateTask(s,D.uid));const a=R.map((t=>t.id===e?s:t));W(a)}catch(t){V("Erro ao atualizar tarefa")}finally{B(!1)}},onClearCompleted:async()=>{try{const e=R.filter((e=>e.completed)),t=R.filter((e=>!e.completed));if(D){B(!0);for(const t of e)t.firebaseId&&await g.deleteTask(t.firebaseId)}W(t),V("Tarefas concluídas removidas com sucesso")}catch(e){V("Erro ao limpar tarefas concluídas")}finally{B(!1)}},filterStatus:G,language:v,isMobile:J}),e.jsx(a,{show:C,message:M,onDismiss:()=>I(!1),language:v})]})})})}function I(){return e.jsx(C,{})}const M=document.getElementById("root");M&&L.createRoot(M).render(e.jsx(o.StrictMode,{children:e.jsx(I,{})}));
