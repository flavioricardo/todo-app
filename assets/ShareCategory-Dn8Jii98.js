import{j as e,P as a}from"./ui-components-form-CWcqC4Wb.js";import{r as i,L as n,A as r,q as l,B as s,d as t,c as o,f as d,h as c,b as h,s as p}from"./vendor-RUKFzHni.js";import{s as g}from"./app-services-C_BzRTV2.js";import{t as m}from"./app-constants-wElj3pIu.js";import{z as b}from"./app-utils-DBK4lIIs.js";import"./vendor-prop-types-CXM-vOnM.js";import"./vendor-firebase-D18ONwfu.js";function f({isOpen:a,onClose:f,categories:y,language:u,user:v,onShareCategory:C,onRemoveShare:x}){const[j,w]=i.useState(""),[z,I]=i.useState(""),[S,T]=i.useState("share"),[k,B]=i.useState(!1),[L,O]=i.useState([]),[R,q]=i.useState([]);i.useEffect((()=>{a&&v&&A()}),[a,v]);const A=async()=>{if(v){B(!0);try{const e=await g.getMyShares(v.uid);O(e);const a=await g.getSharedWithMe(v.uid);q(a)}catch(e){}finally{B(!1)}}};return a?e.jsx(n,{zIndex:b,children:e.jsxs(r,{accessibilityLabel:m[u].shareCategory,heading:m[u].shareCategory,onDismiss:f,footer:e.jsx(s,{display:"flex",justifyContent:"end",padding:2,children:e.jsx(t,{text:m[u].close,onClick:f})}),size:"md",children:[e.jsx(l,{activeTabIndex:"share"===S?0:1,onChange:({activeTabIndex:e})=>{T(0===e?"share":"list")},tabs:[{text:m[u].shareWithUser,id:"share"},{text:m[u].sharing,id:"list"}]}),"share"===S?e.jsxs(s,{padding:4,children:[e.jsx(s,{marginBottom:4,children:e.jsx(o,{id:"categoryToShare",label:m[u].taskCategory,onChange:({value:e})=>w(e),placeholder:m[u].taskCategory,value:j,disabled:k,children:y.map((a=>e.jsx(o.Option,{label:m[u].categories[a]||a,value:a},a)))})}),e.jsx(s,{marginBottom:4,children:e.jsx(d,{id:"targetEmail",onChange:({value:e})=>I(e),placeholder:m[u].emailPlaceholder,label:m[u].shareWith,value:z,type:"email",disabled:k})}),e.jsx(t,{text:m[u].shareCategory,color:"blue",onClick:async()=>{if(j&&z&&v){B(!0);try{await C(j,z),I(""),w(""),A()}catch(e){}finally{B(!1)}}},disabled:!j||!z||k})]}):e.jsxs(s,{padding:4,marginTop:2,children:[e.jsx(c,{weight:"bold",children:m[u].sharedByMe}),0===L.length?e.jsx(s,{padding:2,children:e.jsx(c,{children:m[u].noCustomCategories})}):L.map((a=>e.jsxs(h,{alignItems:"center",justifyContent:"between",gap:2,children:[e.jsxs(s,{flex:"grow",children:[e.jsx(c,{weight:"bold",children:m[u].categories[a.categoryName]||a.categoryName}),e.jsx(c,{size:"100",children:a.targetEmail})]}),e.jsx(t,{text:m[u].removeShare,onClick:()=>(async e=>{B(!0);try{await x(e),A()}catch(a){}finally{B(!1)}})(a.id),color:"red",size:"sm",disabled:k})]},a.id))),e.jsxs(s,{marginTop:4,children:[e.jsx(c,{weight:"bold",children:m[u].sharedWithMe}),0===R.length?e.jsx(s,{padding:2,children:e.jsx(c,{children:m[u].noCustomCategories})}):R.map((a=>e.jsxs(h,{alignItems:"center",gap:2,children:[e.jsx(p,{icon:"person",accessibilityLabel:"User",color:"darkGray"}),e.jsxs(s,{children:[e.jsx(c,{weight:"bold",children:m[u].categories[a.categoryName]||a.categoryName}),e.jsx(c,{size:"100",children:a.targetEmail})]})]},a.id)))]})]})]})}):null}f.propTypes={isOpen:a.bool.isRequired,onClose:a.func.isRequired,categories:a.array.isRequired,language:a.string.isRequired,user:a.object,onShareCategory:a.func.isRequired,onRemoveShare:a.func.isRequired};export{f as default};
