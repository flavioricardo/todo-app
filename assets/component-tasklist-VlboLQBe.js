import{P as e,j as s,t,g as r}from"./components-small-kG-ZNGlu.js";import{r as a,B as i,T as o,d as n,i as g,I as d,j as l}from"./vendor-gestalt-BRg-26zS.js";import{d as c,e as u,k as p,s as m,c as y,q as h,h as x,j as C}from"./vendor-firebase-Cfr0B36E.js";import{d as j}from"./services-BZ9SVSX1.js";import{s as f}from"./utils-DWkyBxVi.js";const T="categories",k={async getUserCategories(e){try{const s=y(j,T),t=h(s,x("userId","==",e)),r=await C(t),a=[],i={};return r.forEach((e=>{const s=e.data();a.push(s.name),void 0!==s.order?i[s.name]=s.order:i[s.name]=999})),0===a.length?f.getCustomCategories():(f.set("categoriesOrder",i),a)}catch(s){throw s}},async addCustomCategory(e,s){try{const t=f.getCategoriesOrder(),r=Object.values(t).reduce(((e,s)=>Math.max(e,s)),0)+1,a=c(j,T,`${e}_${s}`);await p(a,{userId:e,name:s,order:r,createdAt:m()});const i=f.getCustomCategories();return i.includes(s)||(f.set("customCategories",[...i,s]),f.setCategoryOrder(s,r)),await this.getUserCategories(e)}catch(t){throw t}},async removeCustomCategory(e,s){try{const t=c(j,T,`${e}_${s}`);await u(t);const r=f.getCustomCategories();f.set("customCategories",r.filter((e=>e!==s)));const a=f.getCategoriesOrder();return delete a[s],f.set("categoriesOrder",a),await this.getUserCategories(e)}catch(t){throw t}},getCategoryOrderMap:()=>({personal_care:10,meal:20,work:30,household_chores:40,transportation:50,physical_activity:60,social_interaction:70,...f.getCategoriesOrder()}),sortCategoriesByOrder(e){const s=this.getCategoryOrderMap();return[...e].sort(((e,t)=>(void 0!==s[e]?s[e]:999)-(void 0!==s[t]?s[t]:999)))}},q=({task:e,onToggleTask:a,showCategory:o,language:n})=>s.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"between",padding:2,children:[s.jsx(l,{id:`task-${e.id}`,checked:e.completed,label:e.text,onChange:()=>a(e.id)}),o&&s.jsx(g,{text:t[n].categories[e.category]||e.category,type:r(e.category)})]}),R=({category:e,tasks:a,onToggleTask:n,language:l,isMobile:c,isExpanded:u,onToggleExpand:p})=>s.jsxs(i,{marginBottom:2,marginEnd:2,borderStyle:"shadow",color:"elevationFloating",rounding:3,padding:3,userSelect:"none",flex:"grow",column:c||u?12:3,width:u?"100%":void 0,children:[s.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"between",marginBottom:1,children:[s.jsx(o,{size:"sm",children:s.jsx(g,{text:t[l].categories[e]||e,type:r(e)})}),s.jsx(d,{size:"sm",icon:u?"minimize":"maximize",onClick:()=>p(e),accessibilityLabel:u?t[l].minimize:t[l].expand})]}),a.map((e=>s.jsx(q,{task:e,onToggleTask:n,showCategory:!1,language:l},e.id)))]}),w=({language:e})=>s.jsx(i,{padding:3,display:"flex",justifyContent:"center",children:s.jsx(o,{children:t[e].emptyTaskList})});function b({tasks:e,onToggleTask:r,onClearCompleted:g,filterStatus:d,groupBy:l,language:c,isMobile:u}){const[p,m]=a.useState(null),y=e=>{m(p===e?null:e)},h=e.some((e=>e.completed))&&"pending"!==d;return s.jsxs(s.Fragment,{children:[s.jsxs(i,{marginTop:4,width:"100%",children:[s.jsx(i,{marginBottom:2,children:s.jsx(o,{size:"100",children:t[c].taskList})}),s.jsx(i,{display:u||"category"!==l?void 0:"flex",wrap:u||"category"!==l?void 0:"wrap",legend:t[c].taskList,children:(()=>{if(0===e.length)return s.jsx(w,{language:c});if("category"===l){const t=e.reduce(((e,s)=>(e[s.category]||(e[s.category]=[]),e[s.category].push(s),e)),{}),a=k.sortCategoriesByOrder(Object.keys(t));return[...a].sort(((e,s)=>p===e?-1:p===s?1:a.indexOf(e)-a.indexOf(s))).map((e=>s.jsx(R,{category:e,tasks:t[e],onToggleTask:r,language:c,isMobile:u,isExpanded:p===e,onToggleExpand:y},e)))}return e.map((e=>s.jsx(q,{task:e,onToggleTask:r,showCategory:"category"!==l,language:c},e.id)))})()})]}),h&&s.jsx(i,{marginTop:4,width:"100%",display:"flex",children:s.jsx(n,{text:t[c].clearCompleted,onClick:g,color:"red",fullWidth:u,size:u?"lg":"md"})})]})}q.propTypes={task:e.shape({id:e.string.isRequired,text:e.string.isRequired,category:e.string.isRequired,completed:e.bool.isRequired}).isRequired,onToggleTask:e.func.isRequired,showCategory:e.bool.isRequired,language:e.string.isRequired},R.propTypes={category:e.string.isRequired,tasks:e.array.isRequired,onToggleTask:e.func.isRequired,language:e.string.isRequired,isMobile:e.bool,isExpanded:e.bool,onToggleExpand:e.func.isRequired},w.propTypes={language:e.string.isRequired},b.propTypes={tasks:e.arrayOf(e.shape({id:e.string.isRequired,text:e.string.isRequired,category:e.string.isRequired,completed:e.bool.isRequired})).isRequired,onToggleTask:e.func.isRequired,onClearCompleted:e.func.isRequired,filterStatus:e.string.isRequired,groupBy:e.string,language:e.string.isRequired,isMobile:e.bool},b.defaultProps={groupBy:"none",isMobile:!1};export{b as T,k as c};
