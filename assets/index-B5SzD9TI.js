import{j as e,T as t,a as s,t as a,b as o}from"./components-small-CL4oxIsW.js";import{r,l as n,C as i,m as c,n as l,B as d,F as u,o as f}from"./vendor-gestalt-C7yLN_Hx.js";import{a as m}from"./vendor-react-BtDQ8f-S.js";import{G as g,o as h,k as p,l as y,m as j}from"./vendor-firebase-CmEgKLsZ.js";import{A as k}from"./component-header-D6Z0i40i.js";import{L as S}from"./component-login-uBRHh0Ky.js";import{T as b}from"./component-tasklist-DlF0zsmz.js";import{a as w,t as x}from"./services-D0Vd_2IS.js";import{s as T,u as E}from"./utils-DX2N1SK1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var v,L={};var C=function(){if(v)return L;v=1;var e=m();return L.createRoot=e.createRoot,L.hydrateRoot=e.hydrateRoot,L}();function I(){const[m,v]=r.useState(T.get("theme","lightWash")),[L,C]=r.useState(T.get("language","pt")),[I,M]=r.useState(!1),[O,R]=r.useState(""),[W,z]=r.useState([]),[A,D]=r.useState(""),[G,N]=r.useState("all"),[P,B]=r.useState(!1),[F,q]=r.useState(null),[K,H]=r.useState(!1),J=new g,Q=E(),U=new n(10),V=new i([U]);r.useEffect((()=>T.set("theme",m)),[m]),r.useEffect((()=>T.set("language",L)),[L]),r.useEffect((()=>{if(!F){const e=T.get("tasks",[]);z(e)}}),[]),r.useEffect((()=>{const e=h(w,(async e=>{if(q(e),e){B(!0);try{const t=await x.syncTasks(e.uid);z(t),T.set("tasks",t),X("Tarefas sincronizadas com sucesso!")}catch(t){X("Erro ao sincronizar tarefas")}finally{B(!1)}}}));return()=>e()}),[]),r.useEffect((()=>{F||T.set("tasks",W)}),[W,F]);const X=e=>{R(e),M(!0),setTimeout((()=>M(!1)),3e3)},Y=async()=>{try{await j(w),q(null);const e=T.get("tasks",[]);z(e)}catch(e){}},Z=W.filter((e=>{const t=e.text.toLowerCase().includes(A.toLowerCase());return"completed"===G?t&&e.completed:"pending"===G?t&&!e.completed:t}));return e.jsx(c,{deviceType:Q?"mobile":"desktop",children:e.jsx(l,{colorScheme:m,children:e.jsxs(d,{as:"main",margin:"auto",padding:4,width:"100%",color:"lightWash"===m?"lightWash":"dark",rounding:0,justifyContent:"center",display:"block",height:"100vh",children:[e.jsx(k,{theme:m,language:L,isMobile:Q,user:F,toggleTheme:()=>v((e=>"lightWash"===e?"dark":"lightWash")),setLanguage:C,handleSignOut:Y,setOpenLoginModal:H,syncData:async()=>{if(!F)return X(a[L].needLogin),void H(!0);B(!0);try{const e=await x.syncTasks(F.uid);z(e),T.set("tasks",e),X(a[L].syncSuccess)}catch(e){X(a[L].syncError)}finally{B(!1)}}}),e.jsx(S,{isOpen:K,onClose:()=>H(!1),onLoginEmail:async(e,t)=>{try{const s=await p(w,e,t);q(s.user),H(!1)}catch(s){alert("Erro ao logar com email: "+s.message)}},onLoginGoogle:async()=>{try{const e=await y(w,J);q(e.user),H(!1)}catch(e){alert("Erro ao logar com Google: "+e.message)}},onSignOut:Y,user:F,language:L,zIndex:V}),e.jsx(t,{onAddTask:async(e,t)=>{const s={id:Date.now().toString(),text:e,category:t,completed:!1};B(!0);try{if(F){B(!0);const e=await x.addTask(s,F.uid);z((t=>[...t,e]))}else z((e=>[...e,s]))}catch(a){X("Erro ao adicionar tarefa")}finally{B(!1)}},language:L,isMobile:Q,disabled:P}),e.jsx(s,{searchTerm:A,filterStatus:G,onSearchChange:D,onFilterChange:N,language:L,isMobile:Q,disabled:P}),P?e.jsx(u,{alignItems:"center",justifyContent:"center",height:"200px",children:e.jsx(f,{show:!0,accessibilityLabel:a[L].loadingTasks})}):e.jsx(b,{tasks:Z,onToggleTask:async e=>{try{const t=W.find((t=>t.id===e));if(!t)return;const s={...t,completed:!t.completed};F&&s.firebaseId&&(B(!0),await x.updateTask(s,F.uid));const a=W.map((t=>t.id===e?s:t));z(a)}catch(t){X("Erro ao atualizar tarefa")}finally{B(!1)}},onClearCompleted:async()=>{try{const e=W.filter((e=>e.completed)),t=W.filter((e=>!e.completed));if(F){B(!0);for(const t of e)t.firebaseId&&await x.deleteTask(t.firebaseId)}z(t),X("Tarefas concluídas removidas com sucesso")}catch(e){X("Erro ao limpar tarefas concluídas")}finally{B(!1)}},filterStatus:G,language:L,isMobile:Q}),e.jsx(o,{show:I,message:O,onDismiss:()=>M(!1),language:L})]})})})}function M(){return e.jsx(I,{})}const O=document.getElementById("root");O&&C.createRoot(O).render(e.jsx(r.StrictMode,{children:e.jsx(M,{})}));
